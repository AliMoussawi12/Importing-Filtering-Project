<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_361) on Fri Mar 03 15:13:26 EET 2023 -->
<title>UsageService</title>
<meta name="date" content="2023-03-03">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="UsageService";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/service/killbill/SubscriptionService.html" title="class in com.service.killbill"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/service/killbill/UsageService.html" target="_top">Frames</a></li>
<li><a href="UsageService.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.service.killbill</div>
<h2 title="Class UsageService" class="title">Class UsageService</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.service.killbill.UsageService</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">UsageService</span>
extends java.lang.Object</pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../com/service/killbill/UsageService.html#UsageService-KillBillHttpClient-com.configuration.property.KillBillApiProperties-java.util.concurrent.Executor-">UsageService</a></span>(KillBillHttpClient&nbsp;killBillClient,
            <a href="../../../com/configuration/property/KillBillApiProperties.html" title="class in com.configuration.property">KillBillApiProperties</a>&nbsp;apiProperties,
            java.util.concurrent.Executor&nbsp;executor)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>RolledUpUsage</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/service/killbill/UsageService.html#getUsageBySubscriptionId-java.util.UUID-LocalDate-LocalDate-">getUsageBySubscriptionId</a></span>(java.util.UUID&nbsp;subscriptionId,
                        LocalDate&nbsp;startDate,
                        LocalDate&nbsp;endDate)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>SubscriptionUsageRecord</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/service/killbill/UsageService.html#mapUsageRecord-java.lang.String-DateTime-long-">mapUsageRecord</a></span>(java.lang.String&nbsp;subscriptionId,
              DateTime&nbsp;eventTime,
              long&nbsp;consumedAmount)</code>
<div class="block">Maps a subscription ID, event time, and consumed amount to a SubscriptionUsageRecord object.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/service/killbill/UsageService.html#pushingUsageRecord--">pushingUsageRecord</a></span>()</code>
<div class="block">The method pushingUsageRecord() pushes usage records to the KillBill.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../com/model/MeteringData.html" title="class in com.model">MeteringData</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/service/killbill/UsageService.html#pushUsageRecordKillBill-java.util.Map-java.util.List-">pushUsageRecordKillBill</a></span>(java.util.Map&lt;java.lang.String,java.util.UUID&gt;&nbsp;smartMeterSubscriptionIds,
                       java.util.List&lt;<a href="../../../com/model/MeteringData.html" title="class in com.model">MeteringData</a>&gt;&nbsp;smartMeterRecords)</code>
<div class="block">Pushes usage records to KillBill for the given smart meter records and subscription IDs.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>Response</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/service/killbill/UsageService.html#recordUsage-SubscriptionUsageRecord-RequestOptions-">recordUsage</a></span>(SubscriptionUsageRecord&nbsp;body,
           RequestOptions&nbsp;inputOptions)</code>
<div class="block">Records subscription usage in KillBill system.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="UsageService-KillBillHttpClient-com.configuration.property.KillBillApiProperties-java.util.concurrent.Executor-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>UsageService</h4>
<pre>public&nbsp;UsageService(KillBillHttpClient&nbsp;killBillClient,
                    <a href="../../../com/configuration/property/KillBillApiProperties.html" title="class in com.configuration.property">KillBillApiProperties</a>&nbsp;apiProperties,
                    java.util.concurrent.Executor&nbsp;executor)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="recordUsage-SubscriptionUsageRecord-RequestOptions-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordUsage</h4>
<pre>public&nbsp;Response&nbsp;recordUsage(SubscriptionUsageRecord&nbsp;body,
                            RequestOptions&nbsp;inputOptions)
                     throws KillBillClientException</pre>
<div class="block">Records subscription usage in KillBill system.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>body</code> - The subscription usage record to be recorded.</dd>
<dd><code>inputOptions</code> - The request options, including followLocation, accept and content-type headers.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The HTTP response from the KillBill system.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>KillBillClientException</code> - if there is an error while sending the HTTP request.</dd>
</dl>
</li>
</ul>
<a name="getUsageBySubscriptionId-java.util.UUID-LocalDate-LocalDate-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUsageBySubscriptionId</h4>
<pre>public&nbsp;RolledUpUsage&nbsp;getUsageBySubscriptionId(java.util.UUID&nbsp;subscriptionId,
                                              LocalDate&nbsp;startDate,
                                              LocalDate&nbsp;endDate)
                                       throws KillBillClientException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>KillBillClientException</code></dd>
</dl>
</li>
</ul>
<a name="mapUsageRecord-java.lang.String-DateTime-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mapUsageRecord</h4>
<pre>public&nbsp;SubscriptionUsageRecord&nbsp;mapUsageRecord(java.lang.String&nbsp;subscriptionId,
                                              DateTime&nbsp;eventTime,
                                              long&nbsp;consumedAmount)</pre>
<div class="block">Maps a subscription ID, event time, and consumed amount to a SubscriptionUsageRecord object.
 This method is annotated with @Async to indicate that its executed asynchronously.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>subscriptionId</code> - the ID of the subscription in KillBill where subscription and Smart Meter have one to one relation</dd>
<dd><code>eventTime</code> - the time of the metering data</dd>
<dd><code>consumedAmount</code> - the amount of the consumed energy</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a SubscriptionUsageRecord object containing the mapped usage record</dd>
</dl>
</li>
</ul>
<a name="pushingUsageRecord--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pushingUsageRecord</h4>
<pre>public&nbsp;void&nbsp;pushingUsageRecord()
                        throws KillBillClientException</pre>
<div class="block">The method pushingUsageRecord() pushes usage records to the KillBill.
  The method first retrieves the external keys (smart meters) and their corresponding subscription IDs from KillBill.
  Based on this data, the method retrieves metering data from database. This data is then pushed in parallel to KillBill.
  Once the data has been successfully pushed, the method marks the corresponding records in the database as retrieved.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>KillBillClientException</code></dd>
</dl>
</li>
</ul>
<a name="pushUsageRecordKillBill-java.util.Map-java.util.List-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>pushUsageRecordKillBill</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../com/model/MeteringData.html" title="class in com.model">MeteringData</a>&gt;&nbsp;pushUsageRecordKillBill(java.util.Map&lt;java.lang.String,java.util.UUID&gt;&nbsp;smartMeterSubscriptionIds,
                                                            java.util.List&lt;<a href="../../../com/model/MeteringData.html" title="class in com.model">MeteringData</a>&gt;&nbsp;smartMeterRecords)</pre>
<div class="block">Pushes usage records to KillBill for the given smart meter records and subscription IDs.
 This message is working concurrently using executor.execute() , with retry mechanism to record that failed to reach KillBill</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>smartMeterSubscriptionIds</code> - a map of subscription IDs mapped to their corresponding smart meter IDs</dd>
<dd><code>smartMeterRecords</code> - a list of smart meter records to be pushed to KillBill</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a list of metering data that was successfully retrieved</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/service/killbill/SubscriptionService.html" title="class in com.service.killbill"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/service/killbill/UsageService.html" target="_top">Frames</a></li>
<li><a href="UsageService.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
